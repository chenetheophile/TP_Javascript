'use strict';

var _require = require('chi-squared'),
    cdf = _require.cdf;

var _require2 = require('./utils'),
    throwError = _require2.throwError;

var independenceTest = function independenceTest(observed, ddof) {
    if (!Array.isArray(observed) || observed.length === 0) {
        throwError('expected frequency must be an array of size > 0');
    }

    var K = observed.length;
    var M = observed[0].length;
    var df = typeof ddof === 'number' ? ddof : 0;
    var rowSums = Array(K).fill(0);
    var colSums = Array(M).fill(0);
    var n = 0;

    rowSums.forEach(function (rowEle, i) {
        colSums.forEach(function (colEle, j) {
            rowSums[i] += observed[i][j];
            colSums[j] += observed[i][j];
            n += observed[i][j];
        });
    });

    var chiSq = 0;
    rowSums.forEach(function (rowEle, i) {
        colSums.forEach(function (colEle, j) {
            var exp = rowEle * colEle / n;
            chiSq += (observed[i][j] - exp) ** 2 / exp;
        });
    });

    return {
        value: chiSq,
        pValue: 1 - cdf(chiSq, (K - 1) * (M - 1) - df)
    };
};

module.exports = independenceTest;
//# sourceMappingURL=independenceTest.js.map
'use strict';

/* eslint-disable no-param-reassign */
var _require = require('chi-squared'),
    cdf = _require.cdf;

var _require2 = require('./utils'),
    throwError = _require2.throwError,
    reducer = _require2.reducer;

var goodnessOfFit = function goodnessOfFit(observed, expected, ddof) {
    if (!Array.isArray(observed) || observed.length === 0) {
        throwError('expected frequency must be an array of size > 0');
    }
    var df = ddof;
    if (!Array.isArray(expected)) {
        df = expected;
        expected = Array(observed.length).fill(observed.reduce(reducer) / observed.length);
    }

    if (expected.length !== observed.length) {
        throwError('Observed and expected frequency arrays must be of same length');
    }

    if (typeof df !== 'number') {
        df = 0; // default value of df is (length - 1)
    }

    var chisq = observed.reduce(function (a, c, i) {
        return a + (c - expected[i]) ** 2 / expected[i];
    }, 0);
    return {
        value: chisq,
        pValue: 1 - cdf(chisq, observed.length - 1 - df)
    };
};

module.exports = goodnessOfFit;
//# sourceMappingURL=goodnessOfFitTest.js.map